<html>
<head>
<title>Database Mapping</title>
<link rel="stylesheet" href="..\..\..\styles\site.css" type="text/css" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">.highlight { background: #FFFF40; }</style> 
<script type="text/javascript" src="../../../highlight.js"></script></head>
<body onLoad="highlight();">
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#FFFFFF">
<tr>
<td valign="top" class="pagebody">
<h3>Mapping Tab: Database Mapping</h3>
<p>The <b>DB</b> <b>Map</b> sub-tab in the <b>Mapping</b> tab is used to connect Document Variables to database table columns. Documents are only mapped to database tables when it is necessary for their data to be stored in the database. A Document Variable will correspond to a database table column, but it is not mandatory that all Variables will be mapped to that database.</p>
<p>A Document may be mapped to more than one table if the Document has one key and all the database tables that it is being mapped to have the same key column (with exactly the same name and attribute in each database table). A Document cannot be mapped to more than four tables. Moreover, if a document is mapped to multiple tables and contains system field <i>cwordercreationdate</i>, all tables must contain the column CWORDERCREATIONDATE.</p>
<p>It is important to note that the mapping to database will not create the database table(s) if they do not already exist. The SQL statements to create the tables can be generated by the <b>Upgrade System</b> command. If the <b>Skip DB schema generation</b> check box is selected on the <b>DB Map</b> sub-tab, then the corresponding DDL statements will be excluded from the SQL script.</p>
<p>The <b>DB Map</b> sub-tab will be in one of two states the first time you open it.
<ul>
<li>If the Document is derived from a base Document that has DB mapping, the Document will inherit the database schema and table mapping from the base Document. &#160;The DB mapping of the base Document will be shown in blue and neither the schema nor mapping can be changed or removed from the derived Document.</li>
<li>Otherwise, the <b>Disconnected</b> icon will be shown and all fields and tables will be blank.</li>
</ul></p>
<!--<p>The <b>Dynamic DB type</b> check box specifies that several Document types will share the same database table. If this flag is set the Document must have a <em>System document type</em> or <em>System doc type number</em> Variable (or a Variable derived from it).</p>-->
<p><b>Note:</b> In the case of connecting with non-Oracle databases, it is your responsibility to synchronize case-sensitivity.</p>

<p><img src="DocumentMappingDB.jpg" align="absmiddle" border="1" alt=" Database Mapping" /></p>

<h4>Logical Connection</h4>
<p>The <b>Logical Connection</b> field specifies the logical connection at which the Document's tables may be found.</p>

<p>If the project has not yet connected to database, the <b>Connect</b> button appears beside the <b>Logical Connection</b> field. Click it to connect to database via <b>Database Login</b> dialog, which is the same method as if invoking via <a href="../../Service Designer Menu Actions/Database Connect.html">Database / Connect</a> menu command. If the connection is successful, the connection will appear in the <b>Logical Connection</b> field, and the connection state icon will change from <b>Disconnected</b> to <b>Connected</b>.</p>

<p>Once connected to database, choose from the list of logical connections available, which is the same list of <a href="../../../Configuration_Tool_User_Guide/Databases Logical.html">logical connections in Configuration application</a>.</p>

<p>If a database mapping already exists, you may remove the connection and database mapping by clicking the <b>Clear</b> button.  The <b>Confirm Database Clear</b> dialog will open. If the <b>Yes</b> button is clicked, you will be disconnected and the database mapping will be removed.</p>

<p><img src="DocumentMappingDBClear.jpg" align="absmiddle" border="0" alt=" Confirm database Clear" /></p>

<h4>Database Mapping</h4>
<p>A new DB mapping can be created either by selecting the <b>Map to DB</b> item from the Document right-click pop-up menu or by clicking the <b>Map</b> <b>All</b> <b>Unmapped</b> button on the <b>DB Map</b> sub-tab.</p>
<p>When the <b>Map to DB</b> item is selected from the right-click pop-up menu, the default DB mapping will be created with automatically generated table and column names. The <b>Database schema</b> must be specified in the Document before this action, whether it is a new or existing one. In the case of a derived Document, any additional Variables will be mapped to the base Document table if the <b>Map to separate table</b> check box is unselected. If the <b>Map to separate table</b> check box is selected, the additional Variables will be mapped to a separate table. If the Document has more than one base Document with database mappings, the additional Variable will be mapped to a separate table regardless of the <b>Map to separate table</b> check box state.</p>
<p>When using the <b>Map</b> <b>All</b> <b>Unmapped</b> button to create a DB mapping, neither a database connection nor a new <b>Database Schema</b> is required. However, it is recommended that a database schema is either created first or connected too.</p>

<p>When the <b>Map</b> <b>All</b> <b>Unmapped</b> button is clicked, the <b>Map</b> <b>All</b> <b>Unmapped</b> <b>Leaves</b> dialog will open. The dialog generates a default table name based on the Document name and default column names based on the Variable names.</p>
<p><img src="DocumentMappingDBMapLeaves.png" align="absmiddle" border="0" alt=" Map All Unmapped Leaves" /></p>
<p>All generated names in the dialog can be updated. The table name can be modified in the <b>Tables</b> combo box. When connected to a database, the <b>Tables</b> combo box will also contain database table names for selection. The column names in the <b>Columns to add</b> table can be edited in place. The check box in the <b>Exclude</b> column should be selected to not generate a column for the Variable. This allows you to map excluded Variables later to another database table. When connected to a database, the <b>Match</b> <b>existing</b> <b>DB</b> <b>columns</b> <b>only</b> check box will be visible and, if selected, only Variables that match existing database column names will be mapped. This allows you to manually map the rest of the Variables if the database table already contains the required columns but with different names. Click the <b>OK</b> button to add the generated table and columns to the <b>Tables</b> tree.</p>
<p><img src="DocumentMappingDBmapped.jpg" align="absmiddle" border="0" alt=" Document to Database mapping" /></p>
<p>All database tables used in the mapping are shown on the left side of the tab in the <b>Tables</b> tree with their columns. The database tables and their columns may or may not physically exist in the database, therefore, icons are used in the tree to reflect the items' state.</p>
<table class='confluenceTable' border cellpadding="1">
<tbody>
<tr>
<th class='confluenceTh'>Icon</th>
<th class='confluenceTh'>Description</th>
</tr>
<tr>
<td class='confluenceTd'><img src="image150.gif" align="absmiddle" border="0" alt="" /></td>
<td class='confluenceTd'>A table that physically exists in the database.</td>
</tr>
<tr>
<td class='confluenceTd'><img src="image151.gif" align="absmiddle" border="0" alt="" /></td>
<td class='confluenceTd'>A table that does not exist in the database.</td>
</tr>
<tr>
<td class='confluenceTd'><img src="image152.gif" align="absmiddle" border="0" alt="" /></td>
<td class='confluenceTd'>A column that physically exists in the database.</td>
</tr>
<tr>
<td class='confluenceTd'><img src="image153.png" align="absmiddle" border="0" alt="" /></td>
<td class='confluenceTd'>A column that does not exist in the database.</td>
</tr>
</tbody>
</table>
<p>When <b>Disconnected</b>, all tables and columns are shown as not existing in the database. When a connection is established, the tables and columns from the <b>Tables</b> tree will be matched against the existing database structure and their icons will be updated accordingly. The columns in the database will also show a tooltip with their data type information. The <b>Rename</b> and <b>Remove</b> buttons are used to rename or remove tables and columns from the tree. If the <b>Remove</b> button is clicked, any existing mapping to these table(s) or column(s) will be removed as well, after a confirmation message.</p>
<p>All Document Variables are shown on the right side of the tab in the <b>Variables</b> table. The <b>Leaf</b> column shows the Variable label and icon for regular Variables and keys. The <b>Type</b> column shows the Variable data type information. The <b>Don't</b><b>Map</b> column contains check boxes that can be used to exclude a Variable from DB mapping.</p>
<p><strong>Note</strong>: Fields that are mapped to data structure variables appear in bold and have an asterisk (*) at the end. If you find a data structure variable that is displayed with   double asterisks (**), remove the extra * from the label in the metadata.</p>
<p>Color conventions are used for the items in both the <b>Tables</b> tree and <b>Variables</b> table to reflect if the item is mapped or unmapped and if the item belongs to a base or derived Document.</p>
<table class='confluenceTable' border cellpadding="1">
<tbody>
<tr>
<th class='confluenceTh'>Color</th>
<th class='confluenceTh'>Meaning</th>
</tr>
<tr>
<td class='confluenceTd'>Blue</td>
<td class='confluenceTd'>Mapped and belongs to base Document.</td>
</tr>
<tr>
<td class='confluenceTd'>Brown</td>
<td class='confluenceTd'>Mapped and belongs to this Document.</td>
</tr>
<tr>
<td class='confluenceTd'>Grey</td>
<td class='confluenceTd'>Not mapped and belongs to base Document.</td>
</tr>
<tr>
<td class='confluenceTd'>Black</td>
<td class='confluenceTd'>Not mapped and belongs to this Document.</td>
</tr>
</tbody>
</table>
<p>The <b>Map</b> button is used to map an unmapped Variable in the <b>Variables</b> table to an unmapped column in the <b>Tables</b> tree. When a mapped item is selected in either tree or table its corresponding item will be selected on the other side. To unmap a Variable, select the Variable in the <b>Variables</b> table and click the <b>Unmap</b> button.</p>
<p>&nbsp;</p></td>
</tr>
</table>
</body>
</html>
