<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<title>Upload File</title>
<link rel="StyleSheet" href="../../styles/site.css" type="text/css" />
<style type="text/css">.highlight { background: #FFFF40; }</style> 
<script type="text/javascript" src="../../highlight.js"></script></head>

<body onLoad="highlight();">
<table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#FFFFFF">
<tr>
<td valign="top" class="pagebody">
<h2>Upload File</h2>

<p>The Upload File element allows the user at runtime to browse files and upload the file to the database. The Browse button allows the user to select the file to be uploaded and the Upload button saves the file to the database. The file contents are are uploaded to the database and associated with the document specified in the Upload Owner property. Only a single file can be uploaded successfully to each instance of an Upload File element.</p>
<p>A callback method is invoked once the upload has completed in either in error or successfully. The status of the callback is a string that either indicates &quot;success&quot; or an error code that indicates the reason for upload  failure.  The callback method can be used to handle the errors. </p>
<p>The following is an example of the Upload File element user interface at runtime. </p>

<img src="exampleUploadFile.png" alt="Upload File element" border="1">

<p>The Upload File element is a browser-driven control, meaning that its look and   feel differs depending on the Web browser that you are using to view it.   For example, Google Chrome does not use the text field that Firefox uses to show   the file that is currently selected. Instead, Google Chrome uses a label beside the <strong>Upload File</strong>. The <strong>File</strong> input field is for display only, meaning that you cannot enter the  file path  manually.</p>
<h3>Summary</h3>
<table class='confluenceTable' border cellpadding=1>
<tbody>
<tr>
<th width="170" class='referenceTh'>references Variable?</th>
<td width="416" class='referenceTd'>Yes</td>
</tr>
<tr>
<th class='referenceTh'>references Method?</th>
<td class='referenceTd'>Yes, Icon Action, On Enter and Run Trigger. </td>
</tr>
<tr>
<th class='referenceTh'>references Form?</th>
<td class='referenceTd'>No</td>
</tr>
<tr>
<th class='referenceTh'>Allowable Child Elements</th>
<td class='referenceTd'><i>None</i></td>
</tr>
</tbody>
</table>

<h3>Properties</h3>
<table class='confluenceTable' border cellpadding=1>
<tbody>
<tr>
  <th width="100" class='referenceTh'>Property</th>
  <th width="145" class='referenceTh'><a href="Form Elements Overview.htm#mandatoryProperty">Mandatory</a>/Optional</th>
  <th width="1368" class='referenceTh'>Comment</th>
</tr>
<tr>
  <th class='referenceTh'>Name</th>
  <td class='referenceTd'>Mandatory</td>
  <td class='referenceTd'>Name of the Upload File.</td>
</tr>
<tr>
  <th class='referenceTh'>Label</th>
  <td class='referenceTd'>Mandatory</td>
  <td class='referenceTd'>Visual label of the Upload File element. This property is translatable.</td>
</tr>
<tr>
  <th class='referenceTh'>Button Label</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Label name of the <strong>Upload</strong> button, which defaults to <strong>Upload...</strong>. This property is translatable.</td>
</tr>
<tr>
  <th class='referenceTh'>Button Style</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Select from various button styles. This property is only visible when the form exists under an UploadPopup User Interface type.</td>
</tr>
<tr>
<th class='referenceTh'>Callback Method</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>This method is invoked once the upload has been completed either in error or successfully.  The status of the upload completions (success or error) is passed to the uploadCallback property. This  Callback method use the uploadCall back parameter.</td>
</tr>
<tr>
<th class='referenceTh'>Can Sort</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>This property is used when parented by a Table Element and refers to a Finder table column during runtime.  This will allow the user to sort the search results data by ascending or descending order at runtime. Setting this property to <em>False </em>will disable the sorting functionality. By default this functionality is set to <em>True.</em></td>
</tr>
<tr>
<th class='referenceTh'>Cell Alignment</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>Controls the horizontal and vertical positioning of the Upload File in the page or parent element. Default is undefined, which behaves as if it is top-left.</td>
</tr>
<tr>
  <th class='referenceTh'>Cell Column Span</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Only applicable when in a Grid Layout. Specifies the number of columns that the Upload File occupies in the Grid Layout, to the right of current cell. Default is empty, which means it occupies one column.</td>
</tr>
<tr>
  <th class='referenceTh'>Cell Row Span</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'><p>This property provides more flexibility when building a grid-based user interface, instead of using a combination of horizontal and vertical layouts. This property appears when form elements appear under a Grid Layout element and the form element has a parent element. This property specifies the number of rows that the element occupies in the grid layout.</p>
    <p>By default, this field is set to 1. All nine positions are made available for the <strong>Cell Alignment</strong> property if the form element is under a Grid Layout element and has a row span greater than 1, so that the form element can be aligned in nine different positions. With rowspan as 1, only the three centre positions are available.</p>
    <p>To use this property, see the <a href="Element - Button.html#cellRowSpanExample">example</a> for details.</p></td>
</tr>
<tr>
<th class='referenceTh'>Dynamic Label Style</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>The value of this property is a method with a Return type <em>String</em>. In conjunction with the Variable property, this method will dynamically change the style of the label at runtime based on the instructions returned by the method.  The label style returned by the method must exist within the current css file that is being used by the application.</td>
<tr>
  <th class='referenceTh'>Editable</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'><p>This property determines whether the Upload File is enable or disabled at runtime. The values for this property are either <em>True</em> (enabled), <em>False</em> (disabled) or a <em>Permissions</em> method (for example, depending on the user's permissions, this field will be enabled or disabled). If the value is set to <em>True</em> then the user will be able to enter text in the Dialog Text Editor. If the value is set to  <em>False</em>, then the Dialog Text Editor appears but the user is unable to enter text in this dialog box. </p>
    <p><strong>Note:</strong> If a field contains  an editable permission that is either coming from the form field itself, or inherited  from the variable or data type, it takes precedence. Otherwise, the user  interface's editablePerm permission takes over. If this method is not  overwritten, the model's editablePerm permission is used. User interfaces  displayed under another user interface with editablePerm are also be inherited  if the embedded user interfaces do not have their own editablePerm permission. </p></td>
</tr>
<tr>
  <th class='referenceTh'>Error Icon Gap</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'><p>Select this property's checkbox to make a gap for the validation icon. By default, this property is false. </p>
    <p><strong>Note:</strong> This property is available only for left (or default) error orientation. The gap is calculated according to the /cwfv/error.png icon size. When the image is substituted with a smaller one, the gap is also smaller. </p></td>
</tr>
<tr>
  <th class='referenceTh'>Error Icon Orientation</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>This property allows you to configure how an icon are displayed. This property takes the values left (default) and right.</td>
</tr>
<tr>
  <th class='referenceTh'>Height</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Height to be taken up by the Text Area area as defined as an integer value in pixels.  If this element is nested under a Table element, the width and height properties can be set using either the percentage (%) or pixel (px) measurement. If this element is not nested under a Table element, the width and height properties are only available using the pixel setting.</td>
</tr>
<tr>
  <th class='referenceTh'>Include in Tab Order</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'><p>This property allows you to optionally suppress tabbing to any or all form elements. The <strong>Include in Tab Order</strong> property overrides the <a href="../../Configuration_Tool_User_Guide/Configure/System/UI/UItabbing.html">suppress tabbing</a> configuration setting and can take the following values:</p>
    <ul>
      <li>When set to <strong>&lt;Default&gt;</strong>, the element is included in tab order according to global rules and its focusable state.</li>
      <li>If the property is set to <strong>Exclude</strong>, the element is excluded from tabbing even if the element is focusable.</li>
      <li>If the property is set to <strong>Include</strong>, the element is included <em>only if it is focusable</em>, even if all items of that type are excluded through the Suppress Tabbing variable.</li>
    </ul>
    <p><strong>Note:</strong> For menu items and images, the <strong>Can Focus</strong> property affects including the element in the tab order. To ensure that an element is in the tabbing order, select this property.</p></td>
</tr>
<tr>
  <th class='referenceTh'>Label Orientation</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Specifies where the label of the Upload File appears in relation to the Upload File area; can be <i>left</i>, <i>right</i> or <i>top</i> of the Upload File area. The default orientation is <i>right</i>.  However, in a Grid Layout, the default label orientation is defined by the Grid Layout element.  But if a value of this Label Orientation property is specified, than it overrides the Label Orientation property provided by the Grid Layout. </td>
</tr>
<tr>
<th class='referenceTh'>Label Style</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>Choose from styles in the selected stylesheet on the toolbar, which defines the styling of the Label such as font color. Default is NONE.</td>
</tr>
<tr>
  <th class='referenceTh'>On Enter</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>The system calls any script defined in this property. This method is invoked when the Upload File is focused on the Web page and the user presses the ENTER key.</td>
</tr>
<tr>
  <th class='referenceTh'>Remove Label Line</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Select this property's checkbox when the element is in a grid layout and its column span is equal to the grid layout's   number of columns. In other words, if the   field is the only field in that row, this empty line is removed above the element. </td>
</tr>
<tr>
  <th class='referenceTh'>Show Label</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>This property determines whether the label is displayed on the Upload File. Choose from <i>True</i> or <i>False</i>. Default is True which means that the label is displayed.</td>
</tr>
<tr>
<th class='referenceTh'>Show Upload Button</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>This property determines whether the Upload button is displayed on the form. Choose from <i>True</i> or <i>False</i>. Default is True which means that the button is displayed.  It is possible to set this property to False and add a Button element.  Associate the Button element with the Upload file by using the Upload Control Name property on the Button element. These properties are only visible when the form exists under an UploadPopup User Interface type.</td>
</tr>
<tr>
  <th class='referenceTh'>Start Row</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Applicable only when the parent element is a Grid Layout. If true, the Upload File appears in a new row of the grid. If <i>False</i>, it is simply placed in the next available cell. Default is <i>False, </i>which means that the Upload File element does not appear on a new row.</td>
</tr>
<tr>
<th class='referenceTh'>Style</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>Choose from styles within the selected stylesheet (located in the Velocity Studio toolbar), which defines the styling of the button such as positioning and color. Refer to the information on <a href="Modifying URL Mappings and Style Sheets.html">Style Sheets</a> for details on configuration. Default is none.</td>
</tr>
<tr>
  <th class='referenceTh'>Tooltip</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Defines the tooltip text, which is displayed in a hover box when the cursor hovers over the Upload File. Default is empty, which means no tooltip for the Upload File.</td>
</tr>
<tr>
  <th class='referenceTh'>Tooltip Style</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Defines the tooltip style of the text displayed in the hover box when the cursor hovers over the element. The default is empty. Click the <strong>Value</strong> field to select a tooltip style from the list.</td>
</tr>
<tr>
  <th class='referenceTh'>Tooltip Width (px)</th>
  <td class='referenceTd'>Optional</td>
  <td class='referenceTd'>Allows you to change the width of the tooltip popup window statically. Enter the width in pixels. The default value for this property is 0.</td>
</tr>
<tr>
  <th class='referenceTh'>Upload Owner</th>
  <td class='referenceTd'>Mandatory</td>
  <td class='referenceTd'>This is a local variable of type Document or a Method within a Document User Interface. Refer to the Notes section below for a more detailed explanation.</td>
</tr>
<tr>
<th class='referenceTh'>Visible</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>Determines whether the Upload File is visible or not. Choose true (visible) or false (not visible) or from the list of Permission Methods available in the User Interface to bind to the Field.  This property defines the user permissions assigned to this field. Pre-defined system <a href="../Metadata_Objects/Permission/Permissions Velocity.html">Permissions</a> such as addPerm, deletePerm, editablePerm, attachPerm, executePerm, and visiblePerm can be assigned as well as Object Permissions. Defaults to NONE or True, which means no permissions assigned and field is visible. Refer to the notes below for a Visible example.</td>
</tr>
<tr>
<th class='referenceTh'>Width</th>
<td class='referenceTd'>Optional</td>
<td class='referenceTd'>Width to be taken up by the Upload File; can be in integer which is in pixels, or in percentage (for example, "30%") of page width or parent Element. If this field is empty, the Width of the field should be taken up by that defined in the Column Width property of the Grid Layout.  If this element is nested under a Table element, the width and height properties can be set using either the percentage (%) or pixel (px) measurement. If this element is not nested under a Table element, the width and height properties are only available using the pixel setting.</td>
</tr>
</tbody>
</table>

<h3>Notes</h3>
<ul>
<li>If this element is nested under a Table element, the width and height properties can be set using either the percentage (%)  or pixel (px) measurement. If this element is not nested under a Table element, the width and height properties are only available using the pixel setting. </li> 
<li> Any runtime instance of a Document can only have one attachment associated with it, which means that only one file can be associated with each instance of this element.  Any attempt to associate another file will fail.  It is recommended that the upload file element is hidden once a file has been uploaded - This is controlled by the Visible property via permissions.</li>
<li>The File text field as well as the Browser button are not customizable as they are browser controls.</li>
<li>An attempt to upload a "null" file will fail.</li>
<li>Uploading a file containing Byte Order Mark (BOM) characters is supported.</li>
</ul>
<h4>Visible Property</h4>
<p>The example below will check that a Document  has been created (this.model.isStored) but that the user has not uploaded a file (this.model.mimetype = null) to that document. If the user has uploaded a file to the document, then the system will not display the Upload element that has been assigned this Visible property - <em>showUploader</em>.</p>

<img src="exampleUploadVisible.png" alt="Visible Parameter" border="1" />

<h4>Upload Owner Property</h4>
<p>This property value determines where the uploaded file is stored. The values of this property is either a document associated to a database table or a method which is called when the file is uploaded. Both are restricted to the local parent User Interface.  The contents of the attachment are stored in the CWFBLOBATTACHMENT table. <span class="referenceTd"> The CWFBLOBATTACHEMENT table contains two columns or leafs (DocID and Blob).</span> The Blob column stores the actual content of the attachment and the DocID references the attachment. </p>
<b>Document</b>
<ul>
<li><span class="referenceTd">Variable of type <em>Document</em>: The downloaded file will be associated to the document via the DocID.   The Document must contain  a column with  MIMETYPE which stores  the file type. Without a MIMETYPE column/leaf the attachment will be stored as a text field (this is particularly important when storing  an image type file).  </span> ORIGINALFILESPEC is another column or leaf in the table that is required. It stores the file name. </li>
<li>Creating a Document of type cwf_oe.CWDOCATTACHMENT will point to the database table CWDOCATTACHMENT which already contains the columns or leafs DOCID, MIMETYPE and ORIGINALFILESPEC, which would allow for any content type to be uploaded. Careful when using this system table as there are several mandatory fields that need to be updated when the file is uploaded (DocID, DocMetaDataType and VisualKey).<br>
  <br>
</li>

<img src="exampleUploadFileDoc.png" alt="Upload File" border="1" /><br>
<br>
<li>Only 1 (one) file can be uploaded per Document or Upload element. Once a file has been uploaded successfully another element can not be uploaded to the same Document variable. The original file must be deleted before a new file can be uploaded.</li>
<li><strong>cwf_oe.CWDOCATTACHMENT</strong> in the system library can serve as a good example of this setup required for this element and its properties.</li>
</ul>
<p><b>Method</b></p>
<ul>
<li>The script method assigned to this property will be called when a file is uploaded.  The method should be assigned with an Object type parameter <em>com.conceptwave.system.Object</em>.  This object will call an instance of the FileReader scriptable object and may use the APIs available under the<a href="../../JavaScripting in Order Care/com/conceptwave/scripting/FileReader.html"> FileReader</a> for interaction with the uploaded data. This script will contain instructions for uploading the file including the database table for uploading the attachment.</li>
<li>The example below shows <em>file</em> parameter as an instance of the File Reader API (not included).<br>
  <br>

<img src="exampleUploadMethod.png" alt="Upload File" border="1" />
<br>
<br>
</li>
<li>To programmatically access the filename data returned when a user browses for a filename using the Upload File element, do the following:
  <ol>
    <li>Create a custom method (for example, uploadOwnerMethod (), as shown in the previous example) and associate it to the UploadOwner  property in the UI.</li>
    <li> The <em>file</em> parameter is of type FileReader. Proceed to use file.getFileName() or another function of the FileReader object.</li>
    </ol>
  <blockquote>
    <p><strong>Note:</strong> The getFileName() method only returns the filename and not the entire filename path.</p>
  </blockquote>
</li>
</ul>

<h4>Call Back Property</h4>

<ul>
  <li>This property is invoked after the upload completes. During the file upload process, the system can pass the status of the file upload to a &quot;status&quot; parameter. It is necessary to define this parameter as a <em>string</em> in the callback method as shown below to capture &quot;success&quot; or failure indicated by a system generated string that conveys what went wrong during the upload process.

    <br>
    <br>
    <img src="exampleUploadCallBack.png" alt="CallBack Method" border="1" />
    <br>
    <br>
  </li>
<li>Without a Call Back method defined, the client UI will not update itself to convey any changes until another action forces an update.  This means that if the Upload Owner method changes some value that should be reflected in the client UI, the changes will not be seen or could be lost if a Call Back method is not specified.</li>
<li>Below are example the supported CallBack Errors:<br>
  <br>
<table class='confluenceTable' border cellpadding=1>
  <tbody>
  <tr>
  <th width="170" class='referenceTh'>Error Number</th>
  <td width="416" class='referenceTd'><strong>Error Message</strong></td>
  <td width="416" class='referenceTd'><strong>Comments</strong></td>
  </tr>
  <tr>
  <th class='referenceTh'>DE0259</th>
  <td class='referenceTd'>Error when processing attachment of object</td>
  <td class='referenceTd'></td>
  </tr>
  <tr>
  <th class='referenceTh'>DE6038</th>
  <td class='referenceTd'>File uploaded exceeds the maximum file size</td>
  <td class='referenceTd'>The default file size limit is 1MB.</td>
  </tr>
  <tr>
  <th class='referenceTh'>DE6039</th>
  <td class='referenceTd'>No File was uploaded</td>
  <td class='referenceTd'>Empty File or the user clicked the Upload button without selecting a file.</td>
  </tr>
  <tr>
  <th class='referenceTh'>DE6040</th>
  <td class='referenceTd'>Data uploaded is not multipart data</td>
  <td class='referenceTd'>Potentially a corrupted file</td>
  </tr>
  <tr>
  <th class='referenceTh'>DE6044</th>
  <td class='referenceTd'>Unknown error occurred during data upload.</td>
  <td class='referenceTd'></td>
  </tr>
</table>
</li>
</ul>
<br>
<p>&nbsp;</p>
</td>
</tr>
</table>
</body>
</html>
